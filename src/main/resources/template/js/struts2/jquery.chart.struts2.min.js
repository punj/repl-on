/*

 jquery.chart.struts2.js

 Integration of charts with struts 2

 Requires use of jquery.struts2.js

 Copyright (c) 2010 - 2015 Johannes Geppert http://www.jgeppert.com

 Dual licensed under the MIT and GPL licenses:
   http://www.opensource.org/licenses/mit-license.php
   http://www.gnu.org/licenses/gpl.html

*/
'use strict';(function(b){b.struts2_jquery_chart={charts:[],chart:function(f,d){var c=this,h=[],e;0==b.support.leadingWhitespace&&c.require("js/flot/excanvas"+c.minSuffix+".js");c.require("js/flot/jquery.flot"+c.minSuffix+".js");d.crosshair&&c.require("js/flot/jquery.flot.crosshair"+c.minSuffix+".js");(d.xaxis&&"time"===d.xaxis.mode||d.yaxis&&"time"===d.yaxis.mode)&&c.require("js/flot/jquery.flot.time"+c.minSuffix+".js");(d.xaxis&&d.xaxis.axisLabel||d.yaxis&&d.yaxis.axisLabel)&&c.require("js/flot/jquery.flot.axislabels"+
c.minSuffix+".js");d.fill&&c.require("js/flot/jquery.flot.fillbetween"+c.minSuffix+".js");d.stack&&c.require("js/flot/jquery.flot.stack"+c.minSuffix+".js");d.series&&d.series.curvedLines&&c.require("js/flot/curvedLines"+c.minSuffix+".js");d.series&&d.series.pie&&c.require("js/flot/jquery.flot.pie"+c.minSuffix+".js");d.autoresize&&c.require("js/flot/jquery.flot.resize"+c.minSuffix+".js");c.charts[d.id]=[];b.each(d.data,function(a,b){b.href?(b.plot=d,b.plot.data=null,h.push(b)):c.charts[d.id].push(b)});
if(d.onclick||d.onhover)d.grid={},d.onclick&&(d.grid.clickable=!0),d.onhover&&(d.grid.hoverable=!0);e=b.plot(f,c.charts[d.id],d);d.onclick&&f.bind("plotclick",function(a,b,p){var g={};g.plot=e;g.event=a;g.pos=b;g.item=p;c.publishTopic(f,d.onclick,g)});d.onhover&&f.bind("plothover",function(a,b,p){var g={};g.plot=e;g.event=a;g.pos=b;g.item=p;c.publishTopic(f,d.onhover,g)});b.each(h,function(a,b){var e="_s2j_chart_topic"+d.id+a;c.subscribeTopics(f,e,"_s2j_chart",b);c.subscribeTopics(f,b.reloadtopics,
"_s2j_chart",b);c.subscribeTopics(f,b.listentopics,"_s2j_chart",b);b.deferredloading||f.publish(e,b)})}};b.extend(!0,b.struts2_jquery_chart,b.struts2_jquery);b.struts2_jquery_chart.debugPrefix="[struts2_jquery_chart] ";b.subscribeHandler("_s2j_chart",function(f,d){var c=b.struts2_jquery,h=b(f.target),e={},a={},k;d&&b.extend(a,d);f.data&&b.extend(a,f.data);k=a.indicatorid;c.showIndicator(k);c.publishTopic(h,a.onalw,a);c.publishTopic(h,a.onbef,a);e.complete=c.pubCom(f.target,a.onalw,a.oncom,a.targets,
k,a);e.error=c.pubErr(f.target,a.onalw,a.onerr,a.errortext,"html");e.success=function(d,e,f){var l={},k=0,q=!1,r=!1,m=a.plot,n=[];l.data=d;l.status=e;l.request=f;null!==d[a.list]&&(b.isArray(d[a.list])||(q=!0),b.each(d[a.list],function(b,c){var e;q?(e=[],e.push(b),e.push(c)):void 0!==a.listkey&&void 0!==a.listvalue?(e=[],e.push(c[a.listkey]),e.push(c[a.listvalue])):(e=[],e.push(k),e.push(d[a.list][k]));n.push(e);k++}),a.data=n,a.data=n,a.plot=null,b.each(b.struts2_jquery_chart.charts[m.id],function(c,
b){b&&b.id&&b.id===a.id&&(r=!0,b.data=n)}),r||b.struts2_jquery_chart.charts[m.id].push(a),b.plot(h,b.struts2_jquery_chart.charts[m.id],m));a.onsuc&&(c.publishTopic(h,a.onsuc,l),c.publishTopic(h,a.onalw,l))};a.href&&(e.url=a.href,e.data="",a.hrefparameter&&(e.data=a.hrefparameter),e.type=a.requesttype?a.requesttype:"POST",a.formids&&""===e.data&&(c.loadAtOnce||c.require("js/plugins/jquery.form"+c.minSuffix+".js"),b.each(a.formids.split(","),function(a,d){var f=b(c.escId(d)).formSerialize();e.data=
""!==e.data?e.data+"\x26"+f:f})),e.dataType="json",e.data||(e.data={}),a.options=e,c.publishTopic(h,a.onalw,a),c.publishTopic(h,a.onbef,a),b.ajax(e))})})(jQuery);